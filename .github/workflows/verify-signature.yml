name: Verify Signatures

on:
  workflow_dispatch:
  workflow_run:
    workflows: ["Build & Sign Docs"]
    types:
      - completed

jobs:
  verify:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup PowerShell
        uses: PowerShell/setup-pwsh@v2

      - name: Install GPG
        run: sudo apt-get install -y gpg

      - name: Verify signature for ChangeRequest
        run: pwsh scripts/sign-gpg.ps1 -TargetFile docs/releases/ChangeRequest.pdf -Verify

      - name: Verify hash for ChangeRequest
        run: pwsh scripts/verify-hash.ps1 -PdfFile docs/releases/ChangeRequest.pdf
